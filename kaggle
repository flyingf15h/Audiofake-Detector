{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "bc7a5bee",
   "metadata": {
    "_cell_guid": "bd471b6c-3276-4a8c-825f-c6d02a33c1af",
    "_uuid": "f76302e8-954f-487d-9676-fe249f673d31",
    "collapsed": false,
    "execution": {
     "iopub.execute_input": "2025-07-12T21:17:51.115013Z",
     "iopub.status.busy": "2025-07-12T21:17:51.114682Z",
     "iopub.status.idle": "2025-07-12T21:17:52.157099Z",
     "shell.execute_reply": "2025-07-12T21:17:52.155977Z"
    },
    "jupyter": {
     "outputs_hidden": false
    },
    "papermill": {
     "duration": 1.04662,
     "end_time": "2025-07-12T21:17:52.158378",
     "exception": false,
     "start_time": "2025-07-12T21:17:51.111758",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cloning into 'Audiofake-Detector'...\r\n",
      "remote: Enumerating objects: 202, done.\u001b[K\r\n",
      "remote: Counting objects: 100% (202/202), done.\u001b[K\r\n",
      "remote: Compressing objects: 100% (145/145), done.\u001b[K\r\n",
      "remote: Total 202 (delta 103), reused 130 (delta 55), pack-reused 0 (from 0)\u001b[K\r\n",
      "Receiving objects: 100% (202/202), 2.77 MiB | 7.93 MiB/s, done.\r\n",
      "Resolving deltas: 100% (103/103), done.\r\n",
      "/kaggle/working/Audiofake-Detector\n"
     ]
    }
   ],
   "source": [
    "!git clone https://github.com/flyingf15h/Audiofake-Detector\n",
    "%cd Audiofake-Detector "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b4348e9d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-07-12T21:17:52.164057Z",
     "iopub.status.busy": "2025-07-12T21:17:52.163795Z",
     "iopub.status.idle": "2025-07-13T00:26:10.187272Z",
     "shell.execute_reply": "2025-07-13T00:26:10.186223Z"
    },
    "papermill": {
     "duration": 11298.02788,
     "end_time": "2025-07-13T00:26:10.188970",
     "exception": false,
     "start_time": "2025-07-12T21:17:52.161090",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\r\n",
      "Epoch 1/50\r\n",
      "Train Loss: 0.4739\r\n",
      "Val Loss: 0.2740 | Acc: 0.8818 | AUC: 0.9802\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 2/50\r\n",
      "Train Loss: 0.1971\r\n",
      "Val Loss: 0.2488 | Acc: 0.9246 | AUC: 0.9894\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 3/50\r\n",
      "Train Loss: 0.1607\r\n",
      "Val Loss: 0.1647 | Acc: 0.9430 | AUC: 0.9894\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 4/50\r\n",
      "Train Loss: 0.1436\r\n",
      "Val Loss: 0.1852 | Acc: 0.9282 | AUC: 0.9904\r\n",
      "\r\n",
      "Epoch 5/50\r\n",
      "Train Loss: 0.1311\r\n",
      "Val Loss: 0.8694 | Acc: 0.7551 | AUC: 0.9550\r\n",
      "\r\n",
      "Epoch 6/50\r\n",
      "Train Loss: 0.2200\r\n",
      "Val Loss: 0.1100 | Acc: 0.9657 | AUC: 0.9917\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 7/50\r\n",
      "Train Loss: 0.1258\r\n",
      "Val Loss: 0.3735 | Acc: 0.8231 | AUC: 0.9935\r\n",
      "\r\n",
      "Epoch 8/50\r\n",
      "Train Loss: 0.1854\r\n",
      "Val Loss: 0.2962 | Acc: 0.8843 | AUC: 0.9921\r\n",
      "\r\n",
      "Epoch 9/50\r\n",
      "Train Loss: 0.5079\r\n",
      "Val Loss: 0.5216 | Acc: 0.7548 | AUC: 0.8695\r\n",
      "\r\n",
      "Epoch 10/50\r\n",
      "Train Loss: 0.3695\r\n",
      "Val Loss: 0.1913 | Acc: 0.9260 | AUC: 0.9835\r\n",
      "\r\n",
      "Epoch 11/50\r\n",
      "Train Loss: 0.1925\r\n",
      "Val Loss: 0.1145 | Acc: 0.9590 | AUC: 0.9908\r\n",
      "\r\n",
      "Epoch 12/50\r\n",
      "Train Loss: 0.1739\r\n",
      "Val Loss: 0.1167 | Acc: 0.9590 | AUC: 0.9916\r\n",
      "\r\n",
      "Epoch 13/50\r\n",
      "Train Loss: 0.1651\r\n",
      "Val Loss: 0.1048 | Acc: 0.9657 | AUC: 0.9919\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 14/50\r\n",
      "Train Loss: 0.1538\r\n",
      "Val Loss: 0.0945 | Acc: 0.9685 | AUC: 0.9935\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 15/50\r\n",
      "Train Loss: 0.1521\r\n",
      "Val Loss: 0.1427 | Acc: 0.9494 | AUC: 0.9905\r\n",
      "\r\n",
      "Epoch 16/50\r\n",
      "Train Loss: 0.1725\r\n",
      "Val Loss: 0.1092 | Acc: 0.9621 | AUC: 0.9939\r\n",
      "Early stopping.\r\n",
      "\r\n",
      "Final Evaluation\r\n",
      "Accuracy: 0.9685, AUC: 0.9935\r\n",
      "              precision    recall  f1-score   support\r\n",
      "\r\n",
      "        Real       0.99      0.95      0.97      1413\r\n",
      "        Fake       0.95      0.99      0.97      1413\r\n",
      "\r\n",
      "    accuracy                           0.97      2826\r\n",
      "   macro avg       0.97      0.97      0.97      2826\r\n",
      "weighted avg       0.97      0.97      0.97      2826\r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!python train.py"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "6bea13c1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-07-13T00:26:10.198178Z",
     "iopub.status.busy": "2025-07-13T00:26:10.197885Z",
     "iopub.status.idle": "2025-07-13T00:26:24.036152Z",
     "shell.execute_reply": "2025-07-13T00:26:24.035084Z"
    },
    "papermill": {
     "duration": 13.844743,
     "end_time": "2025-07-13T00:26:24.037706",
     "exception": false,
     "start_time": "2025-07-13T00:26:10.192963",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "7c5a2c5a9f66406dbb2c300768bcc4c2",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Uploading...:   0%|          | 0.00/696M [00:00<?, ?B/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "CommitInfo(commit_url='https://huggingface.co/flyingf15h/audiofake-model/commit/5c6a212462e8379a97133a0aa00d6c0791151fda', commit_message='Upload best_model.pth with huggingface_hub', commit_description='', oid='5c6a212462e8379a97133a0aa00d6c0791151fda', pr_url=None, repo_url=RepoUrl('https://huggingface.co/flyingf15h/audiofake-model', endpoint='https://huggingface.co', repo_type='model', repo_id='flyingf15h/audiofake-model'), pr_revision=None, pr_num=None)"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "!pip install -q huggingface_hub\n",
    "from huggingface_hub import login\n",
    "from kaggle_secrets import UserSecretsClient\n",
    "user_secrets = UserSecretsClient()\n",
    "secret_value_0 = user_secrets.get_secret(\"GITHUBAPI\")\n",
    "\n",
    "\n",
    "login(token=secret_value_0)\n",
    "\n",
    "from huggingface_hub import create_repo\n",
    "repo_id = \"flyingf15h/audiofake-model\"\n",
    "create_repo(repo_id=repo_id, exist_ok=True)\n",
    "\n",
    "from huggingface_hub import upload_file\n",
    "\n",
    "upload_file(\n",
    "    path_or_fileobj=\"best_model.pth\",\n",
    "    path_in_repo=\"best_model.pth\",         \n",
    "    repo_id=\"flyingf15h/audiofake-model\",  \n",
    "    repo_type=\"model\"\n",
    ")\n"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "nvidiaTeslaT4",
   "dataSources": [
    {
     "datasetId": 4555568,
     "sourceId": 8130934,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 7843435,
     "sourceId": 12434435,
     "sourceType": "datasetVersion"
    }
   ],
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 11317.808344,
   "end_time": "2025-07-13T00:26:24.471200",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-07-12T21:17:46.662856",
   "version": "2.6.0"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {
     "02905f7872b6414287387fa585df42dc": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_2cd2903bbe1647ac990bf9a6e6065e24",
       "placeholder": "​",
       "style": "IPY_MODEL_0d3f329318cc42a39e27364720380fd8",
       "tabbable": null,
       "tooltip": null,
       "value": " 696M/696M [00:06&lt;00:00, 179MB/s]"
      }
     },
     "0ab01e7f547d4179a662ca13ff2d023a": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "0d3f329318cc42a39e27364720380fd8": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "2cd2903bbe1647ac990bf9a6e6065e24": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "44cc6fa8df384032a1d9f85bbcbc20f5": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "4a6028eb23bf4954afacbff09843f9dc": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "7c5a2c5a9f66406dbb2c300768bcc4c2": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_7fec42fca92042159046cd2de373c71e",
        "IPY_MODEL_fdab517f69f947ad81cca0a1b11ed6e1",
        "IPY_MODEL_02905f7872b6414287387fa585df42dc"
       ],
       "layout": "IPY_MODEL_4a6028eb23bf4954afacbff09843f9dc",
       "tabbable": null,
       "tooltip": null
      }
     },
     "7fec42fca92042159046cd2de373c71e": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_0ab01e7f547d4179a662ca13ff2d023a",
       "placeholder": "​",
       "style": "IPY_MODEL_c119623849c04e7396b0d32824e0eea6",
       "tabbable": null,
       "tooltip": null,
       "value": "Uploading...: 100%"
      }
     },
     "c119623849c04e7396b0d32824e0eea6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "db78db89e6334e49a79c79e1048669f7": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "fdab517f69f947ad81cca0a1b11ed6e1": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_db78db89e6334e49a79c79e1048669f7",
       "max": 696002476.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_44cc6fa8df384032a1d9f85bbcbc20f5",
       "tabbable": null,
       "tooltip": null,
       "value": 696002476.0
      }
     }
    },
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
