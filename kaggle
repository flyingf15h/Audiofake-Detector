{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "4f6f5043",
   "metadata": {
    "_cell_guid": "bd471b6c-3276-4a8c-825f-c6d02a33c1af",
    "_uuid": "f76302e8-954f-487d-9676-fe249f673d31",
    "collapsed": false,
    "execution": {
     "iopub.execute_input": "2025-07-13T03:58:54.640006Z",
     "iopub.status.busy": "2025-07-13T03:58:54.639813Z",
     "iopub.status.idle": "2025-07-13T03:58:55.862398Z",
     "shell.execute_reply": "2025-07-13T03:58:55.861326Z"
    },
    "jupyter": {
     "outputs_hidden": false
    },
    "papermill": {
     "duration": 1.226273,
     "end_time": "2025-07-13T03:58:55.863755",
     "exception": false,
     "start_time": "2025-07-13T03:58:54.637482",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cloning into 'Audiofake-Detector'...\r\n",
      "remote: Enumerating objects: 205, done.\u001b[K\r\n",
      "remote: Counting objects: 100% (205/205), done.\u001b[K\r\n",
      "remote: Compressing objects: 100% (148/148), done.\u001b[K\r\n",
      "remote: Total 205 (delta 105), reused 130 (delta 55), pack-reused 0 (from 0)\u001b[K\r\n",
      "Receiving objects: 100% (205/205), 2.77 MiB | 17.43 MiB/s, done.\r\n",
      "Resolving deltas: 100% (105/105), done.\r\n",
      "/kaggle/working/Audiofake-Detector\n"
     ]
    }
   ],
   "source": [
    "!git clone https://github.com/flyingf15h/Audiofake-Detector\n",
    "%cd Audiofake-Detector "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b91e5f63",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-07-13T03:58:55.868783Z",
     "iopub.status.busy": "2025-07-13T03:58:55.868525Z",
     "iopub.status.idle": "2025-07-13T07:39:52.461397Z",
     "shell.execute_reply": "2025-07-13T07:39:52.460612Z"
    },
    "papermill": {
     "duration": 13256.596926,
     "end_time": "2025-07-13T07:39:52.462980",
     "exception": false,
     "start_time": "2025-07-13T03:58:55.866054",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\r\n",
      "Epoch 1/50\r\n",
      "Train Loss: 0.3721\r\n",
      "Val Loss: 0.6911 | Acc: 0.7707 | AUC: 0.9705\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 2/50\r\n",
      "Train Loss: 0.2026\r\n",
      "Val Loss: 0.1769 | Acc: 0.9416 | AUC: 0.9815\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 3/50\r\n",
      "Train Loss: 0.1577\r\n",
      "Val Loss: 0.0972 | Acc: 0.9703 | AUC: 0.9938\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 4/50\r\n",
      "Train Loss: 0.1512\r\n",
      "Val Loss: 0.1058 | Acc: 0.9646 | AUC: 0.9921\r\n",
      "\r\n",
      "Epoch 5/50\r\n",
      "Train Loss: 0.1291\r\n",
      "Val Loss: 0.1030 | Acc: 0.9710 | AUC: 0.9932\r\n",
      "\r\n",
      "Epoch 6/50\r\n",
      "Train Loss: 0.1284\r\n",
      "Val Loss: 0.2198 | Acc: 0.9041 | AUC: 0.9936\r\n",
      "\r\n",
      "Epoch 7/50\r\n",
      "Train Loss: 0.1317\r\n",
      "Val Loss: 0.1983 | Acc: 0.9222 | AUC: 0.9876\r\n",
      "\r\n",
      "Epoch 8/50\r\n",
      "Train Loss: 0.0877\r\n",
      "Val Loss: 0.0611 | Acc: 0.9805 | AUC: 0.9962\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 9/50\r\n",
      "Train Loss: 0.0778\r\n",
      "Val Loss: 0.0644 | Acc: 0.9809 | AUC: 0.9963\r\n",
      "\r\n",
      "Epoch 10/50\r\n",
      "Train Loss: 0.0741\r\n",
      "Val Loss: 0.0607 | Acc: 0.9798 | AUC: 0.9965\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 11/50\r\n",
      "Train Loss: 0.0648\r\n",
      "Val Loss: 0.0566 | Acc: 0.9820 | AUC: 0.9968\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 12/50\r\n",
      "Train Loss: 0.0640\r\n",
      "Val Loss: 0.0567 | Acc: 0.9816 | AUC: 0.9966\r\n",
      "\r\n",
      "Epoch 13/50\r\n",
      "Train Loss: 0.0620\r\n",
      "Val Loss: 0.0520 | Acc: 0.9841 | AUC: 0.9970\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 14/50\r\n",
      "Train Loss: 0.0608\r\n",
      "Val Loss: 0.0524 | Acc: 0.9844 | AUC: 0.9968\r\n",
      "\r\n",
      "Epoch 15/50\r\n",
      "Train Loss: 0.0542\r\n",
      "Val Loss: 0.0522 | Acc: 0.9837 | AUC: 0.9973\r\n",
      "\r\n",
      "Epoch 16/50\r\n",
      "Train Loss: 0.0571\r\n",
      "Val Loss: 0.0503 | Acc: 0.9858 | AUC: 0.9970\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 17/50\r\n",
      "Train Loss: 0.0526\r\n",
      "Val Loss: 0.0507 | Acc: 0.9837 | AUC: 0.9968\r\n",
      "\r\n",
      "Epoch 18/50\r\n",
      "Train Loss: 0.0540\r\n",
      "Val Loss: 0.0489 | Acc: 0.9866 | AUC: 0.9973\r\n",
      "  *** New best model saved ***\r\n",
      "\r\n",
      "Epoch 19/50\r\n",
      "Train Loss: 0.0511\r\n",
      "Val Loss: 0.0507 | Acc: 0.9837 | AUC: 0.9970\r\n",
      "Early stopping.\r\n",
      "\r\n",
      "Final Evaluation\r\n",
      "Accuracy: 0.9866, AUC: 0.9973\r\n",
      "              precision    recall  f1-score   support\r\n",
      "\r\n",
      "        Real       0.99      0.98      0.99      1413\r\n",
      "        Fake       0.98      0.99      0.99      1413\r\n",
      "\r\n",
      "    accuracy                           0.99      2826\r\n",
      "   macro avg       0.99      0.99      0.99      2826\r\n",
      "weighted avg       0.99      0.99      0.99      2826\r\n",
      "\r\n"
     ]
    }
   ],
   "source": [
    "!python train.py"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "a409c33d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-07-13T07:39:52.472031Z",
     "iopub.status.busy": "2025-07-13T07:39:52.471772Z",
     "iopub.status.idle": "2025-07-13T07:40:16.642344Z",
     "shell.execute_reply": "2025-07-13T07:40:16.641487Z"
    },
    "papermill": {
     "duration": 24.176726,
     "end_time": "2025-07-13T07:40:16.643676",
     "exception": false,
     "start_time": "2025-07-13T07:39:52.466950",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "9e3b65b757f3405ba675bba2b3a361eb",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Uploading...:   0%|          | 0.00/696M [00:00<?, ?B/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "CommitInfo(commit_url='https://huggingface.co/flyingf15h/audiofake-model/commit/20b8240a839180db606130d710319daeaf20b4ae', commit_message='Upload best_model.pth with huggingface_hub', commit_description='', oid='20b8240a839180db606130d710319daeaf20b4ae', pr_url=None, repo_url=RepoUrl('https://huggingface.co/flyingf15h/audiofake-model', endpoint='https://huggingface.co', repo_type='model', repo_id='flyingf15h/audiofake-model'), pr_revision=None, pr_num=None)"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "!pip install -q huggingface_hub\n",
    "from huggingface_hub import login\n",
    "from kaggle_secrets import UserSecretsClient\n",
    "user_secrets = UserSecretsClient()\n",
    "secret_value_0 = user_secrets.get_secret(\"GITHUBAPI\")\n",
    "\n",
    "\n",
    "login(token=secret_value_0)\n",
    "\n",
    "from huggingface_hub import create_repo\n",
    "repo_id = \"flyingf15h/audiofake-model\"\n",
    "create_repo(repo_id=repo_id, exist_ok=True)\n",
    "\n",
    "from huggingface_hub import upload_file\n",
    "\n",
    "upload_file(\n",
    "    path_or_fileobj=\"best_model.pth\",\n",
    "    path_in_repo=\"best_model.pth\",         \n",
    "    repo_id=\"flyingf15h/audiofake-model\",  \n",
    "    repo_type=\"model\"\n",
    ")\n"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "nvidiaTeslaT4",
   "dataSources": [
    {
     "datasetId": 4555568,
     "sourceId": 8130934,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 7843435,
     "sourceId": 12434435,
     "sourceType": "datasetVersion"
    }
   ],
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 13287.871672,
   "end_time": "2025-07-13T07:40:16.976849",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-07-13T03:58:49.105177",
   "version": "2.6.0"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {
     "158e3cc74ffc424db1a349faf69eaa60": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_8ea035d7185f4f1aa14aa9da7a023c70",
       "max": 696002476.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_b0fefca859d74f82aed7211bcf3f359b",
       "tabbable": null,
       "tooltip": null,
       "value": 696002476.0
      }
     },
     "4af353e72a20496780444e1398536ff1": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "5e57b1b7769840b8887d4c82bd73b26e": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "8cf11fac48cc4ac6b9bc5cfc53f1d84d": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_c8c9675b759f4daa8f9023f717037efa",
       "placeholder": "​",
       "style": "IPY_MODEL_efcd189096734f35bcdd3cabc60bfb9f",
       "tabbable": null,
       "tooltip": null,
       "value": " 696M/696M [00:13&lt;00:00, 14.0MB/s]"
      }
     },
     "8ea035d7185f4f1aa14aa9da7a023c70": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "9e3b65b757f3405ba675bba2b3a361eb": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_ebb55295d3c84a8ba866fae3b0a898d6",
        "IPY_MODEL_158e3cc74ffc424db1a349faf69eaa60",
        "IPY_MODEL_8cf11fac48cc4ac6b9bc5cfc53f1d84d"
       ],
       "layout": "IPY_MODEL_b3d707f943994677853cd515c87ff1ae",
       "tabbable": null,
       "tooltip": null
      }
     },
     "b0fefca859d74f82aed7211bcf3f359b": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "b3d707f943994677853cd515c87ff1ae": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "c8c9675b759f4daa8f9023f717037efa": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "ebb55295d3c84a8ba866fae3b0a898d6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_5e57b1b7769840b8887d4c82bd73b26e",
       "placeholder": "​",
       "style": "IPY_MODEL_4af353e72a20496780444e1398536ff1",
       "tabbable": null,
       "tooltip": null,
       "value": "Uploading...: 100%"
      }
     },
     "efcd189096734f35bcdd3cabc60bfb9f": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     }
    },
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
